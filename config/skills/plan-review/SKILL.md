---
description: plan レビュー（フィードバック反映 + 質問）
userInvocable: true
arguments: filename
---

# Plan Review

## Workflow

1. 指定された `{filename}` を読み、計画の全体像を把握する
2. **フィードバック反映**: ファイル内の `XXX:` プレフィックス付きコメントをすべて特定し、計画を改善する
   - 設計への疑問・反対 → 設計を修正
   - 代替案の提案 → 検討して採用/却下を判断
   - 追加要件・制約 → 計画に反映
   - 不足観点の補足 → 追記
   - 反映済みの `XXX:` コメントを削除する。判断が難しいものは `TODO:` として残す
3. **批判的分析**: 計画を以下の観点で分析し、問題点を洗い出す
   - **曖昧な記述**: 実装時に解釈が分かれそうな箇所
   - **考慮漏れ**: エッジケース、エラーハンドリング、既存コードとの整合性など
   - **暗黙の前提**: 明文化されていない仮定や依存関係
   - **設計の選択肢**: 複数のアプローチがありえるのに一つに決め打ちしている箇所
   - **スコープの不明確さ**: やる/やらないの境界が曖昧な箇所
4. 各問題点を `AI-ASK: {質問内容}` の形式で計画ファイルの該当箇所に直接追記する
   - 質問は具体的かつ簡潔に書く
   - 該当セクションの直後に挿入する（関連する文脈のすぐ近くに置く）
5. 反映した内容と追記した質問の一覧をユーザーに提示する
   - `XXX:` もなく質問もない場合は「計画に不明点はありません。実装可能です」と伝えて終了する

## 制約

- **実装は絶対に開始しない。** 計画の改善と質問の追記のみ。
- コードの編集・作成は行わない（プランファイルの更新のみ）。
- 元のファイルのフォーマット・構造を維持する。
